\documentclass[11pt]{article}

% Multi language
\usepackage[english]{babel}
% Unicode package
\usepackage[utf8]{inputenc}
% Citation package
\usepackage[authoryear]{natbib}
% Set margins and line space
\usepackage{geometry}
\geometry{verbose, tmargin=2cm, bmargin=2cm, lmargin=2cm, rmargin=2cm}
\usepackage{setspace}
\onehalfspacing

% Math Packages
\usepackage{amsmath}
\numberwithin{equation}{section}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathrsfs}
\usepackage{bbm}
\usepackage{amstext}

% For tables
\usepackage{multirow}
\usepackage{babel}
\usepackage{array}
\usepackage{rotating}
\usepackage{longtable}
\usepackage{float}
\usepackage{booktabs}
\usepackage{lscape}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Because html converters don't know tabularnewline
\providecommand{\tabularnewline}{\\}

% For figures
\usepackage{caption}
\usepackage{subcaption}

% For algorithms
\usepackage[ruled]{algorithm2e}

% For code
\usepackage{xcolor}
\usepackage{listings}
\usepackage{alltt}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,    captionpos=b,                    
    keepspaces=true, numbers=left,                    
    numbersep=5pt, showspaces=false,                
    showstringspaces=false, showtabs=false, tabsize=2}
\lstset{style=mystyle}


% Graphics
\usepackage{color}
\usepackage{graphicx}

% maxwidth is the original width if it is less than linewidth
% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%
\let\hlipl\hlkwb

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX


% URL Setup
\usepackage{url}
% \usepackage[hidelinks]{hyperref}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=[rgb]{0.6000000, 0.1058824, 0.1176471}, % usc red.
    filecolor=[rgb]{0.6000000, 0.1058824, 0.1176471}, 
    urlcolor=[rgb]{0.6000000, 0.1058824, 0.1176471},
    citecolor=[rgb]{0.6000000, 0.1058824, 0.1176471},
    linkbordercolor=[rgb]{1.0000000, 0.7803922, 0.1725490}, % usc yellow
    citebordercolor=[rgb]{1.0000000, 0.7803922, 0.1725490}, 
    filebordercolor=[rgb]{1.0000000, 0.7803922, 0.1725490}, 
    urlbordercolor=[rgb]{1.0000000, 0.7803922, 0.1725490} 
    }
\urlstyle{same}

% Sections numbered within parts
\usepackage{chngcntr}
\counterwithin*{section}{part}

\renewcommand{\harvardurl}{URL: \url}  

% Utilities
\usepackage{todonotes} 
\newcommand{\CommentZhan}[1]{\todo[inline, color=blue!40]{\textbf{Comment (Zhan): }#1}} 
\newcommand{\CommentJing}[1]{\todo[inline, color=pink!40]{\textbf{Comment (Jing): }#1}} 
\usepackage{rotfloat}
\usepackage{pdfpages}
\usepackage{indentfirst}
\usepackage{enumitem}

% Define theorem environment
\newtheorem{theorem}{Theorem}
\newtheorem{remark}{Remark}
\newtheorem{assumption}{Assumption}
\newtheorem{lemma}{Lemma}
\newtheorem{notation}{Notation}
\newtheorem{example}{Example}
\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}

% Define math operators
\DeclareMathOperator{\argmax}{argmax}
\DeclareMathOperator{\argmin}{argmin}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\vect}{vec}
\DeclareMathOperator{\Rank}{Rank}
\DeclareMathOperator{\plim}{plim}

% Define short cut
\newcommand{\Op}{\mathcal{O}_p}
\newcommand{\sq}[1]{\textquoteleft #1\textquoteright}
\newcommand{\dq}[1]{\textquotedblleft #1\textquotedblright}
\newcommand{\red}{\color{red}}
\newcommand{\E}{\mathbb{E}}

% Set counter
\setcounter{tocdepth}{2}

\AtBeginDocument{\hypersetup{pdfborder={0 0 1}}}